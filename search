<h1>search result</h1>

<h3 id="stores_header">Stores, Shops, and Services</h3>
<div id="search_container_stores" class="store_list_padding search_result">
    <script id="search_template_stores" type="x-tmpl-mustache/text">
        <a href="/stores/{{slug}}">{{name}}</a>
        <p>{{description_trim}}</p>
    </script>
</div>


<h3 id="promotions_header">Upcoming Promotions</h3>    
<div id="search_container_promotions" class="store_list_padding search_result">
    <script id="search_template_promotions" type="x-tmpl-mustache/text">
        <a href="/promotions/{{slug}}">{{name}}</a>
        <p>{{description_trim}}</p>
      
    </script>
</div>
<h3 id="events_header">Upcoming Events</h3>    
<div id="search_container_events"  class="store_list_padding search_result">
    <script id="search_template_events" type="x-tmpl-mustache/text">
        <a href="/events/{{slug}}">{{name}}</a>
        <p>{{description_trim}}</p>
    </script>
</div>



<h3 id="jobs_header">Career Opportunities</h3>    
<div id="search_container_jobs" class="store_list_padding search_result">
    <script id="search_template_jobs" type="x-tmpl-mustache/text">
        <a href="/jobs/{{slug}}">{{name}}</a>
        <p>{{description_trim}}</p>
    </script>
</div>    

<h3 id="genInfo_header">Genreral Information</h3>    
<div id="search_container_genInfo" class="store_list_padding search_result">
    <script id="search_template_genInfo" type="x-tmpl-mustache/text">
        <a href="{{link}}">{{name}}</a>
        <p>{{description_trim}}</p>
    </script>
</div>  
<!--{% assign page_query = result_query["page"] | size %}-->
<!--{% if page_query > 0 %}-->
<!--    <h3>Generial Information</h3>    -->
<!--    {% for item in result_query["page"] %}-->
<!--        <div class="store_list_padding search_result">-->
<!--            <a href="/pages/{{item.slug}}">{{item.title}}</a>-->
<!--            <p>{{item.body | strip_html | truncatewords: 35}}</p>-->
<!--        </div>    -->
<!--    {% endfor %}-->
<!--{% endif %}-->

<script>
    $(window).load(function() {
        $('.flexslider').flexslider({
            animation: "slide",
            controlNav: false,
            directionNav: false,        
            prevText: "Previous",
            nextText: "Next"
        });
    });
    $(document).ready(function(e){
        init(e); 
        
        loadMallData(renderAll); 
    });
        
        //loadMallDataCached(renderAll); 
    function renderAll(){
        var params = getRequestParam('query');
        var search_results = getSVCSearchResults(params,15,300);
        console.log(params, search_results);
        
        if (search_results.stores != undefined && search_results.stores.length > 0){
            renderGeneral('#search_container_stores','#search_template_stores', search_results.stores);
        }
        else{
            $('#stores_header').hide()
        }
        if (search_results.promotions != undefined && search_results.promotions.length > 0){
            renderGeneral('#search_container_promotions','#search_template_promotions', search_results.promotions);
        }
        else{
            $('#promotions_header').hide()
        }
        if (search_results.events != undefined &&  search_results.events.length > 0){
            renderGeneral('#search_container_events','#search_template_events', search_results.events);
        }
        else{
            $('#events_header').hide()
        }
        
        search_results.jobs.sort(function(a, b) {
            var textA = a.name;
            var textB = b.name;
            return (textA < textB) ? -1 : (textA > textB) ? 1 : 0;
        });
        
        if (search_results.jobs != undefined &&  search_results.jobs.length > 0){
            renderGeneral('#search_container_jobs','#search_template_jobs', search_results.jobs);
        }
        else{
            $('#jobs_header').hide()
        }
        $( window ).load(function() {
             if (search_results.genInfo != undefined &&  search_results.genInfo.length > 0){
            renderGeneral('#search_container_genInfo','#search_template_genInfo', search_results.genInfo);
            console.log("Hi!");
            }
            else{
                $('#genInfo_header').hide()
            }
        });
        //console.log(search_results.stores);
        //console.log(search_results.genInfo, (search_results.genInfo.length > 0));
       
        show_content();
       
    }
</script>