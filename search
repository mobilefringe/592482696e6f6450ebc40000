<h1>search result</h1>

{% assign store_query = result_query["stores"] | size %}
{% if store_query > 0 %}
    <h3>Stores, Shops, and Services</h3>
    <div id="search_container_stores">
        <script id="search_template_stores" type="x-tmpl-mustache/text">
            <div class="store_list_padding search_result">
                <a href="/stores/{{item.slug}}">{{item.name}}</a>
            <p>{{description}}</p>
        </div>   
        </script>
    </div>
    {% for item in result_query["stores"] %}
             
    {% endfor %}
{% endif %}

{% assign promo_query = result_query["promo"] | size %}
{% assign event_query = result_query["event"] | size %}
{% if promo_query > 0 or event_query > 0 %}
    <h3>Upcoming Event</h3>    
    {% for item in result_query["promo"] %}
        <div class="store_list_padding search_result">
            <a href="/promotions/{{item.slug}}">{{item.name}}</a>
            <p>{{item.description | strip_html | truncatewords: 35}}</p>
        </div>    
    {% endfor %}
    {% for item in result_query["event"] %}
        <div class="store_list_padding search_result">
            <a href="/events/{{item.slug}}">{{item.name}}</a>
            <p>{{item.description | strip_html | truncatewords: 35}}</p>
        </div>    
    {% endfor %}
{% endif %}

{% assign job_query = result_query["job"] | size %}
{% if job_query > 0 %}
    <h3>Career Opportunities</h3>    
    {% for item in result_query["job"] %}
        <div class="store_list_padding search_result">
            <a href="/jobs/{{item.slug}}">{{item.name}}</a>
            <p>{{item.description | strip_html | truncatewords: 35}}</p>
        </div>    
    {% endfor %}
{% endif %}


{% assign page_query = result_query["page"] | size %}
{% if page_query > 0 %}
    <h3>Generial Information</h3>    
    {% for item in result_query["page"] %}
        <div class="store_list_padding search_result">
            <a href="/pages/{{item.slug}}">{{item.title}}</a>
            <p>{{item.body | strip_html | truncatewords: 35}}</p>
        </div>    
    {% endfor %}
{% endif %}

<script>
    $(document).ready(function(e){
        init(e);
        function renderAll(){
            init_home_hours();
            var params = getRequestParam('query');
            var search_results = getSearchResults(params,10,100);
            if (search_results.stores != undefined && search_results.stores.length > 0){
                renderGeneral('#search_container_stores','#search_template_stores', search_results.stores);
            }
            else{
                $('stores_header').hide()
            }
            if (search_results.promotions != undefined && search_results.promotions.length > 0){
                renderGeneral('#search_container_promotions','#search_template_promotions', search_results.promotions);
            }
            else{
                $('#promotions_header').hide()
            }
            if (search_results.events != undefined &&  search_results.events.length > 0){
                renderGeneral('#search_container_events','#search_template_events', search_results.events);
            }
            else{
                $('#events_header').hide()
            }
            show_content();
        }
        loadMallDataCached(renderAll); 
    })
</script>